<d-nav navType="MEMBER"></d-nav>
<div class="container mt-3">
    <div class="card">
        <div class="card-header">
          Conversations: <span class="text-primary">{{recipientUsername}} <span class="float-right" routerLink="/messages"><i class="material-icons">keyboard_return</i></span></span>
        </div>
        <div class="card-body">
            <div class="pb-3">
                <textarea class="form-control mb-1" [(ngModel)]="newMessageText" placeholder="write a message to {{recipientUsername}}..." [disabled]="isSending"></textarea>
                <button (click)="sendMessage()" class="btn btn-primary btn-sm form-control" [disabled]="isSending"><i class="material-icons align-middle">email</i> Send</button>
            </div>
            
            <div *ngFor="let message of messages">                
                <div *ngIf="userId !== message.fromUser.id">
                    <span class="small text-muted"><b>Received:</b> {{message.sendDate}}</span> <span *ngIf="!message.readDate" class="text-warning small">NEW</span>
                    <div class="card-body card alert-info mb-3">
                        <div class="media"  >
                            <img class="d-flex mr-3" [src]="message.fromUser.profile.profilePhotoUrl" alt="Photo">
                            <div class="media-body">
                                <h5 class="mt-0">{{message.fromUser.username}}</h5> 
                                <div class="pb-1 small text-muted">
                                    <div>{{message.message}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="userId === message.fromUser.id">
                    <span class="small text-muted"><b>Sent:</b> {{message.sendDate}}</span>
                    <div class="card-body card bg-faded mb-3">
                        <div class="media"  >
                            <div class="media-body">
                                <h5 class="mt-0 text-right">{{message.fromUser.username}}</h5> 
                                <div class="pb-1 small text-muted text-right">
                                    <div>{{message.message}}</div>
                                </div>
                            </div>
                            <img class="d-flex ml-3" [src]="message.fromUser.profile.profilePhotoUrl" alt="Photo">
                        </div>
                    </div>
                </div>


            </div>

        </div>
    </div>
</div>

